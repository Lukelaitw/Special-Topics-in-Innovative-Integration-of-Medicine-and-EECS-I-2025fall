============================================================
Conformer 模型評估報告
============================================================
評估時間: 2025-11-30 10:52:30
使用默認模型: ./checkpoints/best_model.pth
============================================================

模型載入完成

============================================================
評估驗證集
============================================================

============================================================
Validation Metrics for Conformer Model
============================================================

Balanced Accuracy: 0.9721

混淆矩陣:
[[4955   59  112]
 [  61 4117   63]
 [  40   22 2857]]

歸一化混淆矩陣 (百分比):
True \ Pred	A	C	F
A	96.66%	 1.15%	 2.18%
C	 1.44%	97.08%	 1.49%
F	 1.37%	 0.75%	97.88%

分類報告:
              precision    recall  f1-score   support

           A     0.9800    0.9666    0.9733      5126
           C     0.9807    0.9708    0.9757      4241
           F     0.9423    0.9788    0.9602      2919

    accuracy                         0.9709     12286
   macro avg     0.9677    0.9721    0.9697     12286
weighted avg     0.9713    0.9709    0.9710     12286


每個類別的 ROC AUC:
  A (Class 0): 0.9967
  C (Class 1): 0.9970
  F (Class 2): 0.9962

宏平均 ROC AUC: 0.9966
加權平均 ROC AUC: 0.9967

============================================================
類別預測分布分析
============================================================
真實分布: {np.str_('A'): np.int64(5126), np.str_('C'): np.int64(4241), np.str_('F'): np.int64(2919)}
預測分布: {np.str_('A'): np.int64(5056), np.str_('C'): np.int64(4198), np.str_('F'): np.int64(3032)}
============================================================

驗證集預測結果已保存到 ./results/

============================================================
評估測試集
============================================================

============================================================
Test Metrics for Conformer Model
============================================================

Balanced Accuracy: 0.9742

混淆矩陣:
[[4343   38   83]
 [  45 3601   49]
 [  42   21 2479]]

歸一化混淆矩陣 (百分比):
True \ Pred	A	C	F
A	97.29%	 0.85%	 1.86%
C	 1.22%	97.46%	 1.33%
F	 1.65%	 0.83%	97.52%

分類報告:
              precision    recall  f1-score   support

           A     0.9804    0.9729    0.9766      4464
           C     0.9839    0.9746    0.9792      3695
           F     0.9494    0.9752    0.9622      2542

    accuracy                         0.9740     10701
   macro avg     0.9712    0.9742    0.9727     10701
weighted avg     0.9742    0.9740    0.9741     10701


每個類別的 ROC AUC:
  A (Class 0): 0.9966
  C (Class 1): 0.9980
  F (Class 2): 0.9957

宏平均 ROC AUC: 0.9968
加權平均 ROC AUC: 0.9969

============================================================
類別預測分布分析
============================================================
真實分布: {np.str_('A'): np.int64(4464), np.str_('C'): np.int64(3695), np.str_('F'): np.int64(2542)}
預測分布: {np.str_('A'): np.int64(4430), np.str_('C'): np.int64(3660), np.str_('F'): np.int64(2611)}
============================================================

測試集預測結果已保存到 ./results/

============================================================
過擬合分析
============================================================
驗證集 Balanced Accuracy: 0.9721
測試集 Balanced Accuracy: 0.9742
過擬合差距: -0.0022
✓ 過擬合程度在可接受範圍內
============================================================

============================================================
生成的可視化圖表
============================================================
驗證集圖表:
  - confusion_matrix_validation.png (混淆矩陣)
  - roc_curves_validation.png (ROC 曲線)
  - class_distribution_validation.png (類別分布)
測試集圖表:
  - confusion_matrix_test.png (混淆矩陣)
  - roc_curves_test.png (ROC 曲線)
  - class_distribution_test.png (類別分布)
============================================================